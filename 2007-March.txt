From rsmudge at mail.berlios.de  Sat Mar 24 01:58:54 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sat, 24 Mar 2007 01:58:54 +0100
Subject: [Jircii-svn] r86 - in rero: lib resources/toplevel
	resources/toplevel/docs src/rero/gui/background
	src/rero/gui/windows src/rero/util src/text/list
Message-ID: <200703240058.l2O0wsC9001070@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-24 01:58:45 +0100 (Sat, 24 Mar 2007)
New Revision: 86

Modified:
   rero/lib/sleep.jar
   rero/resources/toplevel/docs/sleeplang.html
   rero/resources/toplevel/readme.txt
   rero/resources/toplevel/whatsnew.txt
   rero/src/rero/gui/background/BackgroundProperties.java
   rero/src/rero/gui/windows/ChannelWindow.java
   rero/src/rero/util/ClientUtils.java
   rero/src/text/list/ListSelectionSpace.java
Log:
ch ch changes...


Modified: rero/lib/sleep.jar
===================================================================
(Binary files differ)

Modified: rero/resources/toplevel/docs/sleeplang.html
===================================================================
--- rero/resources/toplevel/docs/sleeplang.html	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/resources/toplevel/docs/sleeplang.html	2007-03-24 00:58:45 UTC (rev 86)
@@ -134,7 +134,7 @@
 
 <p>Octal literals can be used as well.  Any number beginning with a 0 is interpreted to be an octal literal. i.e.</p>
 
-<pre>$oct = 077; # same as $var = 63</pre>
+<pre>$oct = 077; # same as $oct = 63</pre>
 
 <p>Another numerical type that sleep supports is called a long.  A long is basically a higher capacity integer.  An integer can 
 be a number between -2,147,483,648 to +2,147,483,648.  A long can be much bigger than that.</p>
@@ -382,6 +382,10 @@
   <td>is the specified value a scalar array</td>
  </tr>
  <tr>
+  <td>-isfunction</td>
+  <td>does the specified scalar hold a function</td>
+ </tr>
+ <tr>
   <td>-ishash</td>
   <td>is the specified value a scalar hash</td>
  </tr>
@@ -568,6 +572,16 @@
    
 <p><code>$x--</code> is equivalent to <code>$x = $x - 1</code>;</p>
 
+<h3>Assignment Operations</h3>
+
+<p>Sleep has a special form of the assignment called an assignment operator.  This is essentially
+the combination of an operator and an assignment in one step. i.e.:</p>
+
+<code>$x += 3;</code>
+
+<p>The example above is equivalent to <code>$x = $x + 3;</code>.  The following are valid assignment
+operations: <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>&amp;=</code>, <code>|=</code>, <code>^=</code>, <code>&lt;&lt;=</code>, <code>&gt;&gt;=</code>, and <code>.=</code>.</p>
+
 <h2><a name="5">Subroutines</a></h2>
 
 <p>Subroutines in sleep are basically mini programs.  You can pass arguments to them and they can return values.</p>
@@ -608,6 +622,82 @@
 <p>The return command causes the current subroutine to stop executing and return to where it started.  You can specify a scalar 
 with return that will be the value of the function call.</p>
 
+<h3><a name="throw"></a>Throwing Errors</h3>
+
+<p>Sometimes an error or condition occurs that you don't want to handle in your subroutine but expect someone would
+want to handle it higher up in the call stack.  This type of thing is referred to as an exceptional condition and 
+Sleep has ample support for "exception" handling.</p>
+
+<p>To notify Sleep that an exception has occured, use the throw command.  The throw command works similiarly to return
+in that it expects you to specify a scalar that will be passed to an exception handler later on.  It is worth noteing
+that if the thrown value evaluates to <var>$null</var> then it will not be thrown.</p>
+
+<pre>sub multiplyBy3
+{
+   if (!-isnumber $1)
+   {
+      throw "&multipyBy3( $+ $1 $+ ) requires a number!";
+   }
+
+   return $1 * 3;
+}</pre>
+
+<p>The subroutine above checks if its argument is a number or not.  If someone where to call <code>multiplyBy3("hi")</code>
+then this function would throw the string "&multiplyBy3(hi) requires a number!" up the call stack.   This string would
+bubble up through the Sleep call stack.  The first part of the call stack to have a handler to catch the exception will 
+get to handle it.  If there are no error handlers in place then a warning message will be printed: 
+"Warning: Uncaught exception: &amp;multiplyBy3(hi) requires a number! at 5".  An uncaught exception will cause the 
+current script to stop executing.</p>
+
+<p>In general, an uncaught exception will be swallowed by Sleep.  There is one special case where this is not true and 
+that is covered under <a href="#interfaces">Sleep Interfaces</a> later in this manual.</p>
+
+<p>So with all of this in mind, hoes does one catch these exception errors?  The answer is to enclose executing code
+into a try / catch block.</p>
+
+<pre>try
+{
+   multiplyBy3("hi");
+}
+catch $message
+{
+   println("Failed to multiply by 3: $message");
+   printAll(getStackTrace());
+}</pre>
+
+<p>The code above will attempt the multiplyBy3 within the try block.  The catch block immediately following the try
+block will catch any error messages that bubble up while the try block is part of the call stack.  This means that if
+<code>&amp;multiplyBy3</code> calls a function that calls another function that throws an exception - your catch block will still work
+for catching that message.</p>
+
+<p>In the example above <var>$message</var> is specified as the place to dump the exception message to.  When an 
+exception handler is invoked, the variable specified after the catch keyword will be populated with the exception
+message.</p>
+
+<p>The function <code>&getStackTrace()</code> is a special function to describe where in your script the thrown message
+originated from and which other functions were executed before leading to the thrown message.</p>
+
+<h4><a name="choice"></a>Choice in Error Handling</h4>
+
+<p>Sleep does not use this mechanism for flagging and reporting errors.  In general errors are made available with 
+<code>&checkError($error)</code>.  This function will return the last reported error message flagged by Sleep or Java.
+If you prefer to handle these types of errors with the try catch mechanism then you have two options:  
+
+<p>You can throw individual errors yourself.  Simply inserting <code>throw checkError($error);</code> in certain places
+will cause the error to be thrown if there is one.  If there is no error, <code>&amp;checkError($error)</code> will
+return <var>$null</var>.  If this is the case then the throw command will not process it.  If there is an error then
+the throw command will throw it and it will bubble up itself.</p>
+
+<p>The other option is to enable the Sleep debug option to cause all errors to be thrown.  This option can be enabled
+by calling: <code>debug(34)</code>.  With this debug option in place anything that would have been available to 
+<code>&amp;checkError()</code> will be automatically converted into an exception and thrown.</p>
+
+<p>The <code>&amp;checkError()</code> mechanism for handling errors is simple, requires little code on your part to
+accomodate, and has support for automatic reporting through Sleep's debug flags.  The try/catch/throw mechanism requires
+writing a little bit more code but the ability to retrieve the full stack trace that created the error condition can
+be valuable for debugging.  Ultimately the choice is yours.  You can handle errors the Sleep <code>&amp;checkError()</code> 
+way, the Java try/catch way, or somewhere in between.</p>
+
 <h3>Arrays and Hashes as Arguments</h3>
 
 <p>Arrays and Hashes can be passed to subroutines as arguments.</p>
@@ -681,6 +771,9 @@
 <var>@foo[3]</var> is set to "Michelangelo".  <var>@foo[3]</var> is now equivalent to a normal string scalar that has the value 
 "Michelangelo".</p>
 
+<p>When referencing an array with the index operator, it is acceptable to use negative indices.  For example to reference the
+last element of <var>@foo</var> one could use <code>@foo[-1]</code>.  Many array functions normalize negative indices as well.</p>
+
 <p>Arrays can be assigned to each other as well.   As stated in the Scalars section assigning an array to another array just 
 copies the reference.   Both <var>@array</var>'s will point to the same data.  A change in one array will affect the other 
 array.</p>
@@ -753,6 +846,29 @@
 <P>If the value on the right hand side of the = assignment is not an array, then the above will act exactly as if <var>$x</var>, 
 <var>$y</var>, and <var>$z</var> had been assigned to the specified value individually.</P>
 
+<p>Assignment operations work with tuple assignment as well.  i.e.:</p>
+
+<code>($x, $y, $z) += 3; # add 3 to $x, $y, and $z</code>
+
+<p>You can also special a right hand side array with an assignment op.  In this case each value
+of the right hand side array will be applied to the corresponding value within the tuple:</p>
+
+<code>($x, $y, $z) *= @(2, 3, 4); # $x = $x * 2; $y = $y * 3; etc..</code>
+
+<h4>Expand Array</h4>
+
+<p>Assignment operators used in conjunction with tuples have one special case.  This is the
+array expansion case.  When a single array is specified within the tuple then the array values
+are expanded within the tuple as if you had type <code>(@array[0], @array[1], ...)</code>.  The
+rest of the rules for tuple assignment apply from this point out.  This has some neat implications.
+For example to add two arrays:</p>
+
+<pre>@a = @(1, 2, 3);
+ at b = @(4, 5, 6);
+(@a) += @b;</pre>
+
+<p>The value of <var>@a</var> is now: @(5, 7, 9).</p>
+
 <h3>Sorting</h3>
 
 <p>Sleep includes functions for sorting arrays.  You can sort arrays numerically (double or int variety), or alphabetically.  To 
@@ -989,11 +1105,34 @@
   <td>tab character</td>
  </tr>
  <tr>
+  <td>\u####</td>
+  <td>16 bit unicode character i.e. "\u0063" is "c"</td>
+ </tr>
+ <tr>
+  <td>\x##</td>
+  <td>8 bit character i.e. "\x6A" is "j"</td>
+ </tr>
+ <tr>
   <td>\\</td>
   <td>back slash \ character</td>
  </tr>
 </table>
 
+<p>Speaking of escapes, parsed literals allow two forms of character literals.  A <code>\x</code> followed by two hex nibbles specifies one character.  16-bit unicode characters can be specified with <code>\u</code> followed by four hex nibbles.</p>
+
+<h3>Normalized Parameters</h3>
+
+<p>Sleep has many functions for manipulating strings.  These functions work as you would expect.  For example:</p>
+
+<pre>$x = left("this is a test", 4);</pre>
+
+<p>The left 4 characters of "this is a test" are "this".  This is all well and good, but we have one other
+trick up our sleeve.  Many of Sleep's string manipulation functions allow a negative index to be specified.  i.e.:</p>
+
+<pre>$x = left("this is a test", -4);</pre>
+
+<p>When a negative index is specified to a string manipulation function, the negative number will be normalized based on the length of the string.  Normalizing occurs by adding the length of the string to the negative number.  So the function above will return the string "this is a ".</p>
+
 <h3>Regular Expressions</h3>
 
 <p>Sleep includes built-in regular expressions.  Regular expressions are a powerful way to parse strings without having to write 
@@ -1097,6 +1236,13 @@
 <p>Remember that sleep is a cross platform scripting language.  As a convention use the / forward slash character as a path 
 separator so that your scripts will work in a platform neutral way.</p>
 
+<h4>Unicode Support</h4>
+
+<p>Sleep is unicode friendly.  &amp;println, &amp;print, &amp;readc, &amp;readln, and &amp;read will
+convert read in data using the platforms default charset.  If this is a problem use &amp;readb and
+&amp;writeb to read and write raw bytes from the handle.  To change the charset encoder/decoder for a 
+handle use the &amp;setEncoding function.</p>
+
 <h3>Callback Reading</h3>
 
 <p>Another way of reading data from a scalar object with a handle is to use callback reading.  Callback reading is done with the 
@@ -1161,6 +1307,56 @@
 <p>Calling closef on a process will kill the process.  The above program executes the UNIX command ls -al which lists all of the 
 files in the current directory with some details.</p>
 
+<h3>Buffers</h3>
+
+<p>For those times when speed is a necessity Sleep provides the loveable byte buffer.  A buffer is simply
+a segment of memory that can be written to (and eventually read from) using Sleep's I/O functions. 
+Buffers are fast.  If there is a need to concatenate lots of data or to manipulate streams of data then
+buffers are a must.</p>
+
+<p>To allocate a buffer use the allocate function.  Buffers are initially write-only once allocated.</p>
+
+<pre>$buffer = allocate(1024 * 10); # allocate a 10K buffer</pre>
+
+<p>Once allocated this buffer can be written just like a file:</p>
+
+<pre>println($buffer, "this is some text, in the buff!");
+writeb($buffer, 33);</pre>
+
+<p>Calling &amp;closef on a write-only buffer will turn it into a read-only buffer.  Once a writeable 
+buffer has been closed, it can then be read from.</p>
+
+<pre>closef($buffer);
+$string = readln($buffer);
+$byte   = readb($buffer, 1);</pre>
+
+<p>Calling &amp;closef on a read-only buffer will deallocate the buffer's resources.</p> 
+
+<b>Example:</b>
+
+<p>To encrypt a file with a simple XOR scheme:</p>
+
+<pre># read the file in
+$input = openf(@ARGV[0]);
+$data = readb($input, lof(@ARGV[0]));
+closef($input);
+
+# encrypt the contents of the file...
+$buffer = allocate(strlen($data));
+
+for ($x = 0; $x < strlen($data); $x++)
+{
+   writeb($buffer, chr(byteAt($data, $x) ^ 0x34));
+} 
+
+closef($buffer); # buffer is readable now..
+$data = readb($buffer, strlen($data));
+
+# write the file out
+$output = openf(">" . @ARGV[0]);
+writeb($output, $data);
+closef($output);</pre>
+
 <h3>Pipes</h3>
 
 <p>Sometimes it is helpful for a script to execute multiple tasks concurrently.  Each task being executed at the same time by a 
@@ -1382,8 +1578,10 @@
 <p>Sleep will try to find the specified jar file (i.e. jdom.jar) using the Sleep classpath.  This value is the
 sleep.classpath accessible as systemProperties()["sleep.classpath"].</p>
 
-<h3>Sleep Interfaces</h3>
+<p>If the jar filename includes spaces, you can surround it with single or double quotes.</p>
 
+<h3><a name="interfaces"></a>Sleep Interfaces</h3>
+
 <p>A neat feature of HOES is how interfaces can be quickly and easily created and passed to Java objects.  A Java interface
 defines methods that a Java class should implement to facilitate interacting with certain objects.  </p>
 
@@ -1424,6 +1622,8 @@
 only message passed to ActionListener interfaces is the actionPerformed message.  The button_pressed subroutine is passed as a 
 closure parameter in this line: <code>[$button addActionListener:&button_pressed];</code>.</p>
 
+<p>Any uncaught exceptions originating from a Sleep script will bubble up to the Java caller of the Sleep interface.</p>
+
 <h3>Scalar Conversions</h3>
 
 <p>Sleep automatically converts scalar data into the appropriate Java types when necessary.  Sleep strings map easily to Java 
@@ -1455,8 +1655,11 @@
 
 <h3>Catching Exceptions</h3>
 
-<p>Often times Java API's acessed via HOES can throw an "exception".  Exceptions are a mechanism used to notify programs that some type of error has occured.  You can check for an exception using the <code>checkError($scalar)</code> function.</p>
+<p>Often times Java API's acessed via HOES can throw an "exception".  Exceptions are a mechanism used to notify programs that some type of error has occured.  You can check for an exception using the <code>checkError($scalar)</code> function.  The value returned by checkError() will be the actual Exception object.  This object can be used within object expressions.</p>
 
+<p>If you prefer a more Java-esque method of handling exceptions, Sleep does have a <a href="#throw">try/catch/throw</a> mechanism that can
+be utilized.</p>
+
 <h2><a name="10a">Sleep Closures</a></h2>
 
 <p>Closely coupled with HOES is the concept of Sleep closures.  A closure in sleep is a block of code that contains its own 
@@ -1514,6 +1717,22 @@
 <p>Another special variable available within closures is the <var>$this</var> variable.  <var>$this</var> refers to "this" 
 closure.</p>
 
+<h4>Indexing Closures</h4>
+
+<p>The index operation applied to a closure obtains a value from the closure's "this" scope.</p>
+
+<pre>sub life_universe_and_everything
+{
+   this('$answer');
+   $answer = 42;
+}
+
+life_universe_and_everything(); # nothing is available until 
+                                # the function actually executes
+
+println("What is the meaning of it all? " . &life_universe_and_everything['$answer']);
+&life_universe_and_everything['$question'] = "Unknown?!?";</pre>
+
 <h3>Accumulator Example</h3>
 
 <p>This first example is a Sleep Accumulator Generator.  An Accumulator Generator is a function that takes a parameter
@@ -1660,7 +1879,6 @@
   <th width="240">Function</th>
   <th>Description</th>
  </tr>  
-
  <tr>
   <td>$</td>
   <td>add(@array, $scalar, [index])</td>
@@ -1785,6 +2003,11 @@
  </tr>
  <tr>
   <td>@</td>
+  <td>splice(@array, @insert, [n], [m])</td>
+  <td>removes m characters at position n from @array and splices in the contents of @insert.  @insert can be null.  default value of n is 0; default value of m is the length of @insert.</td>
+ </tr>
+ <tr>
+  <td>@</td>
   <td>subarray(@array, n, [m])</td>
   <td>extracts a subarray of range n-m from @array</td>
  </tr>
@@ -1904,11 +2127,6 @@
  </tr>
  <tr>
   <td>$</td>
-  <td>getFilePath("/path/file")</td>
-  <td>returns the file path extracted from the full path</td>
- </tr>
- <tr>
-  <td>$</td>
   <td>getFileProper("path", "file", ...)</td>
   <td>combines /path and files into an appropriate filename and path for the current platform.</td>
  </tr>
@@ -1929,8 +2147,8 @@
  </tr>
  <tr>
   <td>@</td>
-  <td>ls("directory")</td>
-  <td>gets a list of all the files in the specified directory</td>
+  <td>ls(["directory"])</td>
+  <td>gets a list of all the files in the specified directory.  if no directory is specified, the current directory is listed.</td>
  </tr>
  <tr>
   <td></td>
@@ -1979,6 +2197,13 @@
   <td>returns a sleep string array of all the keys in %hash</td>
  </tr>
  <tr>
+  <td>%</td>
+  <td>putAll(%hash, @|&amp;, [@|&amp;])</td>
+  <td>populates the hash with the specified iterators.  If only one iterator is specified then the second argument
+  is assumed to be the same as the first.  The first iterator is iterated over to obtain the keys for the hash
+  and the second iterator is iterated over to obtain the values.</td>
+ </tr>
+ <tr>
   <td></td>
   <td>remove(%hash, $key, ...)</td>
   <td>removes all specified keys from %hash</td>
@@ -2000,6 +2225,11 @@
  </tr>  
  <tr>
   <td>$</td>
+  <td>allocate([initial size])</td>
+  <td>allocates a writeable memory buffer.  calling closef on the returned buffer turns it into a readable buffer.  calling closef on a readable buffer frees the buffer.</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>available([$handle])</td>
   <td>returns the number of bytes available for reading from $handle</td>
  </tr>
@@ -2040,11 +2270,22 @@
  </tr>
  <tr>
   <td>$</td>
-  <td>exec("command")</td>
-  <td>executes the specified command and returns a $handle.  Check for issues executing a process with checkError()</td>
+  <td>consume($handle, n, [buffer size])</td>
+  <td>reads and discards up to n bytes from the specified handle.  this is useful for causing data to be read and processed without the expensive conversion process
+      to sleep strings (i.e. when one wants to digest or checksum a file)</td>
  </tr>
  <tr>
   <td>$</td>
+  <td>exec("command", [%env], ["directory"])</td>
+  <td>executes the specified command and returns a $handle.  Check for issues executing a process with checkError().  If $null is specified for either the environment (%env) or the starting "directory" then the process will inherit the current processes settings.  The "command" string is broken apart by whitespace and each token is interpreted as a separate argument to the process.</td>
+ </tr>
+ <tr>
+  <td>$</td>
+  <td>exec(@command, [%env], ["directory"])</td>
+  <td>executes the first element of the command array and returns a $handle.  Check for issues executing a process with checkError().  If $null is specified for either the environment (%env) or the starting "directory" then the process will inherit the current processes settings.  Elements 1..n of @command are interpreted as separate arguments to the process regardless of whitespace.</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>fork(&amp;closure, ...)</td>
   <td>executes the specified &amp;closure as a new thread in an isolated script environment.  the return value is a $handle
       that can be used to read/write data from/to the isolated environment.  Within the isolated environment data can be
@@ -2114,20 +2355,35 @@
  <tr>
   <td>$</td>
   <td>readb([$handle], n)</td>
-  <td>reads n bytes from $handle</td>
+  <td>reads n bytes from $handle.  If 0 bytes are read <var>$null</var> will be returned.</td>
  </tr>
  <tr>
   <td>$</td>
+  <td>readc([$handle])</td>
+  <td>reads a single character from the specified handle</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>readln([$handle])</td>
   <td>reads a single line of text from the specified handle</td>
  </tr>
  <tr>
+  <td>$</td>
+  <td>readObject([$handle])</td>
+  <td>reads a serialized scalar back from the specified handle</td>
+ </tr>
+ <tr>
   <td></td>
   <td>reset([$handle])</td>
   <td>resets this IO stream back to the last mark</td>
  </tr>
  <tr>
   <td>$</td>
+  <td>setEncoding($handle, "charset name")</td>
+  <td>sets the character set to encode/decode written/read characters with the specified handle.</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>skip([$handle], n)</td>
   <td>tells the handle to skip the next n bytes</td>
  </tr>
@@ -2148,6 +2404,11 @@
   <td>writeb([$handle], "string")</td>
   <td>writes the byte data of "string" to $handle</td>
  </tr>
+ <tr>
+  <td>$</td>
+  <td>writeObject([$handle], $scalar, ...)</td>
+  <td>serializes and writes all of the scalar arguments out to the specified handle</td>
+ </tr>
 </table>
 
 <p>Note: STDIN/STDOUT will be used by default for any of the IO read/write functions if a $handle is not specified.</p>
@@ -2336,6 +2597,11 @@
  </tr>
  <tr>
   <td>$</td>
+  <td>byteAt("string", n)</td>
+  <td>returns the byte (really its an intger) at the n'th position in the string</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>cast("string", 't')</td>
   <td>casts "string" into an object scalar representing a native java array of type t where t can be b = byte, c = char.</td>
  </tr>
@@ -2351,8 +2617,8 @@
  </tr>
  <tr>
   <td>$</td>
-  <td>indexOf("string", "substr")</td>
-  <td>returns the index of "substr" inside of "string"</td>
+  <td>indexOf("string", "substr", [start])</td>
+  <td>returns the index of "substr" inside of "string" starting at the specified start index.</td>
  </tr>
  <tr>
   <td>$</td>
@@ -2452,7 +2718,7 @@
  <tr>
   <td>$</td>
   <td>checkError([$scalar])</td>
-  <td>returns the last error message to occur.  if a $scalar is specified : $scalar is set to the error string.  Once chekError() is called the error message is cleared.  Functions that might flag an error will be documented.</td>
+  <td>returns the last error message to occur.  if a $scalar is specified : $scalar is set to the error string.  Once chekError() is called the error message is cleared.  Functions that might flag an error will be documented.  Any type of Scalar can be returned by checkError(). i.e. often times the error message might be a Java exception Object.</td>
  </tr>
  <tr>
   <td>$</td>
@@ -2468,7 +2734,7 @@
  <tr>
   <td>$</td>
   <td>debug(level)</td>
-  <td>explicitly enables the specified debug level for this script: 0 - no debugging; 1 - show only critical errors (default); 2 - show all warnings; 4 - show first time use of non-declared variables; 8 - trace all function calls.  any of the levels can be |'d together.</td>
+  <td>explicitly enables the specified debug level for this script: 0 - no debugging; 1 - show only critical errors (default); 2 - show all messages flagged for retrieval with checkError(); 4 - show first time use of non-declared variables; 8 - trace all function calls (collects profiler statistics); 24 - trace only for the purpose of collecting profiler statistics; 34 - "throw" all messages flagged for use with checkError() - this allows use of try/catch to deal with errors.  any of the levels can be |'d together.</td>
  </tr>
  <tr>
   <td>$</td>
@@ -2477,6 +2743,11 @@
  </tr>
  <tr>
   <td>$</td>
+  <td>exit()</td>
+  <td>causes the currently executing script context to exit.</td>
+ </tr>
+ <tr>
+  <td>$</td>
   <td>expr("expr")</td>
   <td>parses and evaluates the specified sleep expression code returning the value of the expression.  syntax errors can be obtained with &amp;checkError()</td>
  </tr>
@@ -2486,21 +2757,52 @@
   <td>obtains the function handle for the function bound to the specified string</td>
  </tr>
  <tr>
+  <td>@</td>
+  <td>getStackTrace()</td>
+  <td>in the context of a catch block (try/catch handlers) this function will return a trace of the Sleep call stack
+      that caused the exceptional condition.  Returns an empty array otherwise.</td>
+ </tr>
+ <tr>
   <td>$</td>
   <td>global('$x $y')</td>
   <td>parses the specified string and declares all variables in the string as global variables.</td>
  </tr>
  <tr>
+  <td></td>
+  <td>include("/path/to/file.sl")</td>
+  <td>compiles and executes the specified script file in the current script context.</td>
+ </tr>
+ <tr>
+  <td></td>
+  <td>include(["/file.jar"], "/path/to/script.sl")</td>
+  <td>compiles and executes the specified script file in the current script context.  this form of the include function looks for script.sl inside of file.jar.</td>
+ </tr>
+ <tr>
+  <td>$</td>
+  <td>invoke(&amp;closure, @args, ["message"], ...)</td>
+  <td>invokes the specified closure using the specified array for each individual argument.  the message parameter ($0) can be specified as well.  Optional named parameters include <i>message</i>, <i>$this</i> which specifies the closure scope to execute with, and <i>parameter</i> which is a hash of all key/value pairs to pass to the function.</td>
+ </tr>
+ <tr> 
   <td>&amp;</td>
   <td>lambda(&amp;closure,&nbsp;$key&nbsp;=&gt;&nbsp;"value",&nbsp;...)</td>
-  <td>copies &amp;closure into a new closure.  The closure environment is initialized with all of the key/value pair arguments.</td>
+  <td>copies &amp;closure into a new closure.  The closure environment is initialized with all of the key/value pair arguments.  If <var>$this</var> => &amp;closure is specified then the resulting closure will share a <var>$this</var> scope with the specified &amp;closure.</td>
  </tr>
+ <tr> 
+  <td>&amp;</td>
+  <td>let(&amp;closure,&nbsp;$key&nbsp;=&gt;&nbsp;"value",&nbsp;...)</td>
+  <td>The specified closure's environment is updated with all of the key/value pair arguments.  Returns the specified closure.</td>
+ </tr>
  <tr>
   <td></td>
   <td>local('$x $y')</td>
   <td>parses the specified string and declares all variables in the string as local variables.</td>
  </tr>
  <tr>
+  <td>@</td>
+  <td>profile()</td>
+  <td>returns the profiler statistics for the current script environment.  Profile statistics will only be collected if DEBUG_TRACE_CALLS (8) or DEBUG_TRACE_PROFILE_ONLY (24) is set.</td>
+ </tr>
+ <tr>
   <td></td>
   <td>release($semaphore)</td>
   <td>increments the count value of the specified semaphore.</td>
@@ -2512,8 +2814,8 @@
  </tr>
  <tr>
   <td></td>
-  <td>setField(class|$object, "field", value)</td>
-  <td>sets a public/protected field of the specified class or instance of $object to a specified value.</td>
+  <td>setField(class|$object, field => value, ...)</td>
+  <td>sets any number of public/protected fields of the specified class or instance of $object to a corresponding value.</td>
  </tr>
  <tr>
   <td>$</td>
@@ -2545,6 +2847,11 @@
   <td>use("/path/to/file.jar", "Loadable")</td>
   <td>loads the specified class into the current script environment.  The sleep.interfaces.Loadable class is loaded from the specified jar file.  Use to import sleep modules and the like.</td>
  </tr>
+ <tr>
+  <td></td>
+  <td>watch('$x $y')</td>
+  <td>A useful debug function for tracking variable changes.  parses the specified string and declares all variables in the string as "watch" variables.  Any attempt to update the container *referenced* by a watch variable will print out a warning.</td>
+ </tr>
 </table>
 
 <h2><a name="12">Appendix A - System Properties</a></h2>
@@ -3289,6 +3596,11 @@
   <td>mark this point in the IO stream (for reads only)</td>
  </tr>
  <tr>
+  <td>o</td>
+  <td>variable</td>
+  <td>sleep scalar object (used to serialize/deserialize scalars)</td>
+ </tr>
+ <tr>
   <td>R</td>
   <td>0</td>
   <td>reset this stream to the last mark point (reads only)</td>

Modified: rero/resources/toplevel/readme.txt
===================================================================
--- rero/resources/toplevel/readme.txt	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/resources/toplevel/readme.txt	2007-03-24 00:58:45 UTC (rev 86)
@@ -1,5 +1,5 @@
  ------- -------------------- ---------   ---------------  ------- ---------
-jIRCii - Beta (40) 10.12.06 - README
+jIRCii - Beta (41) 03.23.07 - README
 -  ------------- -------- -   ---------------- --       -    -     -     - - -
 
 The official jIRCii homepage is at: http://jircii.hick.org

Modified: rero/resources/toplevel/whatsnew.txt
===================================================================
--- rero/resources/toplevel/whatsnew.txt	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/resources/toplevel/whatsnew.txt	2007-03-24 00:58:45 UTC (rev 86)
@@ -1,3 +1,14 @@
+Beta    41 release 23 Mar 07
+====
+- Updated to Sleep 2.1-b14 (is it even released yet?).  Lots of changes.
+  Scripters (and indirectly users) shall be pleased.  
+  See the full changelog at: http://sleep.hick.org/changelog.html
+- Fixed a bug where a popup trigger on MacOS X could also trigger a
+  mouse clicked event (causing inadvertant creation of query windows
+  even when you don't want them).
+- Fixed a bug that caused psuedo transparency image to be recalculated 
+  with every window resize.  Made psuedo transparency mode incredibly slow.
+
 Beta    40 release 12 Oct 06
 ====
 - Improved find dialog slightly, if there's any previous search text in

Modified: rero/src/rero/gui/background/BackgroundProperties.java
===================================================================
--- rero/src/rero/gui/background/BackgroundProperties.java	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/src/rero/gui/background/BackgroundProperties.java	2007-03-24 00:58:45 UTC (rev 86)
@@ -15,6 +15,8 @@
    protected Image image;
    protected Image transform;
 
+   protected String name;
+
    protected Color bgColor; 
    protected float bgTint;
 
@@ -70,14 +72,30 @@
 
    public void init(Color defaultColor, int defaultType, int defaultStyle, float defaultTint)
    {
-      image          = null;
-      transform      = null;
-      bgType         = ClientState.getClientState().getInteger(type + ".bgtype"  , defaultType);
-      bgColor        = ClientState.getClientState().getColor(  type + ".color"   , defaultColor);
-      bgTint         = ClientState.getClientState().getFloat(  type + ".tint"    , defaultTint);
-      bgStyle        = ClientState.getClientState().getInteger(type + ".bgstyle" , defaultStyle);
+      int _bgType, _bgStyle;
+      Color _bgColor;
+      float _bgTint;
+      boolean _isRelative;
+      String _name;
 
-      isRelative     = ClientState.getClientState().isOption(  type + ".relative", false);
+      _name           = ClientState.getClientState().getString(type + ".image", "background.jpg");
+      _bgType         = ClientState.getClientState().getInteger(type + ".bgtype"  , defaultType);
+      _bgColor        = ClientState.getClientState().getColor(  type + ".color"   , defaultColor);
+      _bgTint         = ClientState.getClientState().getFloat(  type + ".tint"    , defaultTint);
+      _bgStyle        = ClientState.getClientState().getInteger(type + ".bgstyle" , defaultStyle);
+      _isRelative     = ClientState.getClientState().isOption(  type + ".relative", false);
+
+      if (!_name.equals(name) || bgColor == null || bgType != _bgType || !bgColor.equals(_bgColor) || bgTint != _bgTint || bgStyle != _bgStyle || isRelative != _isRelative)
+      {
+         name           = _name;
+         bgType         = _bgType;
+         bgColor        = _bgColor;
+         bgTint         = _bgTint;
+         bgStyle        = _bgStyle;
+         isRelative     = _isRelative;
+         image          = null;
+         transform      = null;
+      }
    }
 
    public Image getImage(Component c)

Modified: rero/src/rero/gui/windows/ChannelWindow.java
===================================================================
--- rero/src/rero/gui/windows/ChannelWindow.java	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/src/rero/gui/windows/ChannelWindow.java	2007-03-24 00:58:45 UTC (rev 86)
@@ -69,7 +69,7 @@
 
           public void mouseClicked(MouseEvent ev)
           {
-             if (ev.getClickCount() >= 2)
+             if (ev.getClickCount() >= 2 && !ev.isPopupTrigger() && (ev.getButton() & MouseEvent.BUTTON3) != MouseEvent.BUTTON3)
              {
                 fireClickEvent(ev);
              }

Modified: rero/src/rero/util/ClientUtils.java
===================================================================
--- rero/src/rero/util/ClientUtils.java	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/src/rero/util/ClientUtils.java	2007-03-24 00:58:45 UTC (rev 86)
@@ -61,9 +61,9 @@
         String taglines[] = {
             "highly caffeinated",
             "Fat butane, grubbin' on French fries",
-            "<JakieChan> butan: java sucks",
             "Clean. Christian. Comprehensive.",
-            "If idiots could fly, IRC would be an airport"
+            "If idiots could fly, IRC would be an airport",
+            "I'm a *p0rn* star"
         };
         int r = ctime() % taglines.length;
         return taglines[r];

Modified: rero/src/text/list/ListSelectionSpace.java
===================================================================
--- rero/src/text/list/ListSelectionSpace.java	2006-10-20 22:33:22 UTC (rev 85)
+++ rero/src/text/list/ListSelectionSpace.java	2007-03-24 00:58:45 UTC (rev 86)
@@ -62,9 +62,10 @@
 
     public void mousePressed(MouseEvent ev)
     {
-        if (ev.getButton() == MouseEvent.BUTTON1 && !(ev.isShiftDown() && ev.isControlDown()) )
+        if (ev.getButton() == MouseEvent.BUTTON1 && !ev.isPopupTrigger() && !(ev.isShiftDown() && ev.isControlDown()) )
         {
-           if ((ev.getModifiers() & MouseEvent.CTRL_MASK) == MouseEvent.CTRL_MASK)
+           if ((ev.getModifiers() & MouseEvent.CTRL_MASK) == MouseEvent.CTRL_MASK ||
+               (ev.getModifiers() & MouseEvent.ALT_MASK) == MouseEvent.ALT_MASK)
            {
               ListElement temp = data.getElementAtLocation(ev.getY());
 



From rsmudge at mail.berlios.de  Sat Mar 24 02:05:06 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sat, 24 Mar 2007 02:05:06 +0100
Subject: [Jircii-svn] r87 - in rero/src/rero: config gui/background
Message-ID: <200703240105.l2O156D6001533@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-24 02:05:06 +0100 (Sat, 24 Mar 2007)
New Revision: 87

Modified:
   rero/src/rero/config/ClientDefaults.java
   rero/src/rero/gui/background/BackgroundProperties.java
Log:
yet another checkin...


Modified: rero/src/rero/config/ClientDefaults.java
===================================================================
--- rero/src/rero/config/ClientDefaults.java	2007-03-24 00:58:45 UTC (rev 86)
+++ rero/src/rero/config/ClientDefaults.java	2007-03-24 01:05:06 UTC (rev 87)
@@ -78,7 +78,7 @@
 
    public static final boolean update_ial     = true;
 
-   public static final String  version_string = "10.12.06";
+   public static final String  version_string = "03.24.07";
 
    static
    {

Modified: rero/src/rero/gui/background/BackgroundProperties.java
===================================================================
--- rero/src/rero/gui/background/BackgroundProperties.java	2007-03-24 00:58:45 UTC (rev 86)
+++ rero/src/rero/gui/background/BackgroundProperties.java	2007-03-24 01:05:06 UTC (rev 87)
@@ -96,6 +96,14 @@
          image          = null;
          transform      = null;
       }
+
+      /* we still want to redo all of this if we're not relative to the desktop and the style calls for transforming
+         relative to the window.  after all this function is called when something changes to the window */ 
+      if (!isRelative && (bgStyle == BackgroundUtil.STYLE_FILL || bgStyle == BackgroundUtil.STYLE_STRETCHED))
+      {
+         image = null;
+         transform = null;
+      }
    }
 
    public Image getImage(Component c)



From rsmudge at mail.berlios.de  Sat Mar 24 19:08:45 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sat, 24 Mar 2007 19:08:45 +0100
Subject: [Jircii-svn] r88 - in rero: . resources/toplevel
	resources/toplevel/docs src/rero/gui src/rero/gui/background
	src/rero/test src-apple src-apple/jIRCii.app/Contents
Message-ID: <200703241808.l2OI8jqM009932@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-24 19:08:44 +0100 (Sat, 24 Mar 2007)
New Revision: 88

Modified:
   rero/build.xml
   rero/resources/toplevel/docs/jircii.faq
   rero/resources/toplevel/whatsnew.txt
   rero/src-apple/Info.plist-modify
   rero/src-apple/jIRCii.app/Contents/Info.plist
   rero/src/rero/gui/SessionManager.java
   rero/src/rero/gui/background/BackgroundProperties.java
   rero/src/rero/test/QuickConnect.java
   rero/src/rero/test/WindowTest.java
Log:
part of the phear-u-phear-me suite...


Modified: rero/build.xml
===================================================================
--- rero/build.xml	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/build.xml	2007-03-24 18:08:44 UTC (rev 88)
@@ -42,7 +42,7 @@
   </target>
 
   <target name="clean" description="clean up" >
-    <delete dir="${build}"/>
+    <delete dir="${project.build}"/>
   </target>
 
   <target name="docs" description="generate java documentation">

Modified: rero/resources/toplevel/docs/jircii.faq
===================================================================
--- rero/resources/toplevel/docs/jircii.faq	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/resources/toplevel/docs/jircii.faq	2007-03-24 18:08:44 UTC (rev 88)
@@ -1,4 +1,4 @@
-jircii faq - distributed with jircii 07.18.05:
+jircii faq - distributed with jircii 03.24.07:
 
                .sS$$Ss.                           .sS$$Ss. .sS$$Ss.
                $$$$$$$$                           $$$$$$$$ $$$$$$$$
@@ -9,7 +9,7 @@
          $$$$$$ $$$$$$ $$$$$$ $$$$$$ $$$$$$ $$$$$$ $$$$$$   $$$$$$
          $$$$$$ $$$$$$ $$$$$$ $$$$$$ $$$$$$        $$$$$$   $$$$$$
   """""" $$$$$$ $$$$$$ $$$$$$        $$$$$$ $$$$$$ $$$$$$   $$$$$$
-  $$$$$$ $$$$$$ $$$$$$ $$$$$$ 071805 $$$$$$ $$$$$$ $$$$$$   $$$$$$
+  $$$$$$ $$$$$$ $$$$$$ $$$$$$ 032407 $$$$$$ $$$$$$ $$$$$$   $$$$$$
   $$$$$$ $$$$$$ $$$$$$ $$$$$$        `?$$$$s$$$$P' $$$$$$   $$$$$$
   `?$$$$s$$$$P'                                        
 
@@ -30,7 +30,7 @@
  9. What do the faded nicknames in the channel listbox mean?
 10. What is a jIRCii theme?
 11. How do I copy and paste in jIRCii?
-12. I can't cut text with Ctrl+X, what's wrong?
+12. How do I cycle channels in the status window?
 13. Where does jIRCii store its settings?
 14. How do I edit the jIRCii color scheme?
 15. How can I change ________ in the default jIRCii script?
@@ -57,24 +57,25 @@
 31. How do I change the statusbar color?
 32. How can I set a background image in jIRCii?
 33. Can I make jIRCii windows transparent?
+34. How do I strip jIRCii's GUI to only the essentials?
 
-34. Why don't you allow plugins written in Java, C, Python, Visual Basic etc.?
+35. Why don't you allow plugins written in Java, C, Python, Visual Basic etc.?
 
-35. Will you ever charge money for jIRCii?
-36. Can I get the jIRCii source code?
-37. Can I use portions of jIRCii's source code in my GPL project?
-38. What do the release designations (stable, beta) mean?
-39. How do I embed jIRCii into my website?
+36. Will you ever charge money for jIRCii?
+37. Can I get the jIRCii source code?
+38. Can I use portions of jIRCii's source code in my GPL project?
+39. What do the release designations (stable, beta) mean?
+40. How do I embed jIRCii into my website?
 
-40. What development environment do you use?
-41. Why write another Java IRC Client?
-42. What clients did you rip^H^H^H receive inspiration from?
-43. How long has jIRCii been in development?
-44. Why don't you wait until you have more changes to do a release?
+41. What development environment do you use?
+42. Why write another Java IRC Client?
+43. What clients did you rip^H^H^H receive inspiration from?
+44. How long has jIRCii been in development?
+45. Why don't you wait until you have more changes to do a release?
 
-45. I disabled my jircii menubar, how do I get it back?
-46. How do I reset the jIRCii settings?
-47. My jIRCii window flashes or acts crazy occasionally, what's wrong?
+46. I disabled my jircii menubar, how do I get it back?
+47. How do I reset the jIRCii settings?
+48. My jIRCii window flashes or acts crazy occasionally, what's wrong?
 
 If a question you would like answered is not here then post your question to 
 the jIRCii Message Board at http://jircii.hick.org/jirc/wwwboard.prl
@@ -225,19 +226,23 @@
     paste.  Or you can use the cut, copy, paste keyboard shortcuts specific
     to your operating system.
 
-12. I can't cut text with Ctrl+X, what's wrong?
+12. How do I cycle channels in the status window?
 
-    Beleive it or not this actually isn't a bug.  jIRCii binds Ctrl+X by
-    default to switch the current active query in case you are IRC'ing out
-    of your status window (i.e. all auto /window options turned off).  
+    In the past, jIRCii bound Ctrl+X to do this ala BitchX.  Many Windows 
+    users complained that they could not cut text and rogue contributors
+    removed this feature.  
 
-    This is consistent with the Ctrl+X binding used by BitchX.  If you would
-    like Ctrl+X to provide the normal service of cutting text, paste the
-    following into notepad, save it, and load it into jIRCii:
+    To try to ease the pain, Ctrl+Z has been bound to the previous behavior
+    of Ctrl+X.  jIRCii binds Ctrl+Z by default to switch the current active 
+    query in case you are IRC'ing out of your status window (i.e. all auto 
+    /window options turned off).  
 
+    If you would like Ctrl+X to provide the service of cycling active channels, 
+    paste the following into notepad, save it, and load it into jIRCii:
+
     bind Ctrl+X
     {
-       cutSelectedText();
+       cycleQuery();
     }
 
 13. Where does jIRCii store its settings?
@@ -581,8 +586,38 @@
     configurations for your window backgrounds.  This is the only eye candy
     you'll get so enjoy it.
 
-34. Why don't you allow plugins written in Java, C, Python, Visual Basic etc.?
+34. How do I strip jIRCii's GUI to only the essentials?
 
+    Yes, the true power of jIRCii is you can have a GUI client that feels like
+    mIRC or you can strip it down to the bare essentials so you feel like you
+    are irc'ing out of a terminal window.  The choice of which extreme and to
+    which extent is yours.  
+
+    To disable all of the GUI elements in jIRCii:
+    a. Select View->Options->Auto /Window
+    b. Disable auto /window for everything (you can reenable this stuff later
+       but ideally, I assume you want to IRC out of one window, correct?)
+    c. Select the "GUI Setup" item from the left hand side tree control.
+    d. Uncheck all items under "Interface Elements"
+    e. Select the ""Switchbar" item from the left hand side tree control.
+    f. Uncheck "Enable Switchbar"
+    g. Click "Ok".
+
+    Now on some operating systems, upon restarting jIRCii, you will notice
+    a 1 pixel border around the jIRCii window.  If you want to get rid of this
+    (afterall, every pixel is valuable) then type the following in a jIRCii
+    window:
+
+    h. /eval setProperty("notabs.border", 0);
+
+    Now comes the final step:
+
+    i. restart jIRCii for everything to take effect.
+
+    Before you know it, you'll be irc'ing console style.  pHEAR!
+
+35. Why don't you allow plugins written in Java, C, Python, Visual Basic etc.?
+
     Some people have asked me why I use sleep and not some masterpeice of 
     a language like Python.  Short answer is this:
 
@@ -606,12 +641,12 @@
 
     As for plugins and such.  Why not just modify the source code?
 
-35. Will you ever charge money for jIRCii?
+36. Will you ever charge money for jIRCii?
 
     No.  jIRCii is my gift to the IRC community.  Therefor I can't charge
     money for the client.  However I may charge for shipping and handling.
 
-36. Can I get the jIRCii source code?
+37. Can I get the jIRCii source code?
 
     Yes!  jIRCii is an open source client.  jIRCii source code and 
     binaries are released under the artistic license.  
@@ -635,7 +670,7 @@
     source project so long as I receive some form of credit for the code
     I wrote.  If you modify it please note that too.
 
-37. Can I use portions of jIRCii's source code in my GPL project?
+38. Can I use portions of jIRCii's source code in my GPL project?
 
     Short answer, yes.  I grant you permission to use any jIRCii code "I
     wrote" licensed under the artistic license in your GPL project and to
@@ -645,7 +680,7 @@
     of the license feels like a bit of a lock-in to me.  However feel 
     free to do what you need to do.  :)
 
-38. What do the release designations (stable, beta) mean?
+39. What do the release designations (stable, beta) mean?
 
     No one has asked me this yet. However I'm going to answer because I'm 
     sure someone is curious. 
@@ -657,7 +692,7 @@
     recently released beta. As such stable releases are considered stable 
     since they've been tested by people other than me. 
 
-39. How do I embed jIRCii into my website?
+40. How do I embed jIRCii into my website?
 
     You can do this by using the jIRCii launch service.  jIRCii launch
     service provides a way of specifying an irc server and a channel when
@@ -671,7 +706,7 @@
     More info about jIRCii launch service can be found at:
     http://jircii.hick.org/jirc/link.prl
 
-40. What development environment do you use?
+41. What development environment do you use?
 
     Don't laugh, I use pico as my text editor.  I should be shot.  Or
     maybe given an award for writing over 40,000 lines of code in pico.
@@ -695,11 +730,11 @@
     10.3.4.  jIRCii development in the past has been done on Linux using
     the same type of environment and on Windows using editplus.  
 
-41. Why write another Java IRC Client?
+42. Why write another Java IRC Client?
 
     I don't own a TV or a playstation and I needed something to do.
 
-42. What clients did you rip^H^H^H receive inspiration from?
+43. What clients did you rip^H^H^H receive inspiration from?
 
     Years ago back when I was an IRC scripter.  I wrote an addon called
     mIRCii.  mIRCii was essentially a multi-server addon for mIRC.  You
@@ -729,7 +764,7 @@
     mIRC gets points for heavy influence by default.  Since mIRC is the 
     client most people use.
 
-43. How long has jIRCii been in development?
+44. How long has jIRCii been in development?
 
     I started writing jIRCii when I was in high school.  This was mostly
     an effort to learn Java.  jIRC was my senior project for my high school
@@ -784,7 +819,7 @@
     Short answer:  I've been working on this client for a looong freaking
     time.  
 
-44. Why don't you wait until you have more changes to do a release?
+45. Why don't you wait until you have more changes to do a release?
 
     Good question.  You may notice the main package jIRCii classes are 
     stored in is named "rero".  I named the jIRCii package this because
@@ -808,7 +843,7 @@
     then I recommend downloading a released labeled stable and just
     waiting until the next stable release ignoring betas in between.  
 
-45. I disabled my jircii menubar, how do I get it back?
+46. I disabled my jircii menubar, how do I get it back?
 
     Open up the options dialog using Alt+O.  From there navigate to 
     "GUI Setup" near the bottom.  Make sure the box "Show menubar" is
@@ -818,7 +853,7 @@
     This could be due to a rogue script that got loaded.  The best thing 
     to do in this case is to reset your jIRCii settings.
 
-46. How do I reset the jIRCii settings?
+47. How do I reset the jIRCii settings?
 
     You should only need to do this if your jIRCii settings become really 
     messed up.  Symptoms of messed up settings include nothing happening
@@ -840,7 +875,7 @@
  
     Do a file search for .jIRC and delete it.   
 
-47. My jIRCii window flashes or acts crazy occasionally, what's wrong?
+48. My jIRCii window flashes or acts crazy occasionally, what's wrong?
 
     Java uses a lot of video card hardware tricks to enhance performance.
     Unfortunately buggy video card drivers can cause problems with the

Modified: rero/resources/toplevel/whatsnew.txt
===================================================================
--- rero/resources/toplevel/whatsnew.txt	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/resources/toplevel/whatsnew.txt	2007-03-24 18:08:44 UTC (rev 88)
@@ -1,13 +1,28 @@
-Beta    41 release 23 Mar 07
+Beta    41 release 24 Mar 07
 ====
 - Updated to Sleep 2.1-b14 (is it even released yet?).  Lots of changes.
-  Scripters (and indirectly users) shall be pleased.  
   See the full changelog at: http://sleep.hick.org/changelog.html
+
+  Highlights include:
+  -- Addition of try/catch blocks and a throw command
+  -- Watch variables to assist with debugging 
+  -- an include function for including external files into a script
+  -- a profiler for seeing where your scripts spend all their time
+  -- assignment ops i.e. +=, *=, /= etc.  
+  -- performance enhancements and several bug fixes!!
+
 - Fixed a bug where a popup trigger on MacOS X could also trigger a
   mouse clicked event (causing inadvertant creation of query windows
   even when you don't want them).
 - Fixed a bug that caused psuedo transparency image to be recalculated 
-  with every window resize.  Made psuedo transparency mode incredibly slow.
+  with every window resize.  Resizing with psuedo transparency should feel
+  a little faster now.
+- Disabled apple.awt.showGrowBox property in Info.plist, this stops the 
+  drawing of the OS X grow box in the lower right corner (functionallity it
+  is still there, this just prevents the box itself from obscuring the client)
+- jIRCii Weblaunch/command line options to specify irc URL now allows
+  ircs:// URLs for connecting to an SSL server.  Port information is allowed
+  as well.
 
 Beta    40 release 12 Oct 06
 ====

Modified: rero/src/rero/gui/SessionManager.java
===================================================================
--- rero/src/rero/gui/SessionManager.java	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src/rero/gui/SessionManager.java	2007-03-24 18:08:44 UTC (rev 88)
@@ -115,20 +115,8 @@
 
             if (QuickConnect.IsQuickConnect())
             {
-               String ircServer = QuickConnect.GetInformation().getServer();
-
                addSession();
-               ServerData sdata = ServerData.getServerData();
-               Server stemp = sdata.getServerByName(ircServer);
-  
-               if (stemp != null)
-               {
-                  getSession(getComponentAt(0)).executeCommand(stemp.getCommand());
-               }
-               else
-               {
-                  getSession(getComponentAt(0)).executeCommand("/server " + ircServer + " " + QuickConnect.GetInformation().getPort());
-               }
+               getSession(getComponentAt(0)).executeCommand(QuickConnect.GetInformation().getConnectCommand());
             }
             else if (temp.getList().size() == 0)
             {

Modified: rero/src/rero/gui/background/BackgroundProperties.java
===================================================================
--- rero/src/rero/gui/background/BackgroundProperties.java	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src/rero/gui/background/BackgroundProperties.java	2007-03-24 18:08:44 UTC (rev 88)
@@ -96,14 +96,6 @@
          image          = null;
          transform      = null;
       }
-
-      /* we still want to redo all of this if we're not relative to the desktop and the style calls for transforming
-         relative to the window.  after all this function is called when something changes to the window */ 
-      if (!isRelative && (bgStyle == BackgroundUtil.STYLE_FILL || bgStyle == BackgroundUtil.STYLE_STRETCHED))
-      {
-         image = null;
-         transform = null;
-      }
    }
 
    public Image getImage(Component c)

Modified: rero/src/rero/test/QuickConnect.java
===================================================================
--- rero/src/rero/test/QuickConnect.java	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src/rero/test/QuickConnect.java	2007-03-24 18:08:44 UTC (rev 88)
@@ -18,6 +18,23 @@
       info  = _info;
    }
 
+   public String getConnectCommand()
+   {
+      StringBuffer doit = new StringBuffer();
+      doit.append("/server ");
+
+      if (isSSL())
+      {
+         doit.append("-ssl ");
+      }
+
+      doit.append(getServer());
+      doit.append(" ");
+      doit.append(getPort());
+
+      return doit.toString();
+   } 
+
    public static QuickConnect GetInformation() 
    {
       return qc;
@@ -36,6 +53,12 @@
       return "Guest_" + (System.currentTimeMillis() % 100);
    }
 
+   public boolean isSSL()
+   {
+       System.out.println(info.getScheme());
+       return "ircs".equals(info.getScheme());
+   }
+
    public String getPort()
    {
       if (info.getPort() > -1)

Modified: rero/src/rero/test/WindowTest.java
===================================================================
--- rero/src/rero/test/WindowTest.java	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src/rero/test/WindowTest.java	2007-03-24 18:08:44 UTC (rev 88)
@@ -138,7 +138,7 @@
       //
       // check for an irc:// specified on the command line...
       //
-      if (ARGNO < args.length && args[ARGNO].indexOf("irc://") > -1)
+      if (ARGNO < args.length && (args[ARGNO].indexOf("irc://") > -1 || args[ARGNO].indexOf("ircs://") > -1))
       {
          try
          {

Modified: rero/src-apple/Info.plist-modify
===================================================================
--- rero/src-apple/Info.plist-modify	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src-apple/Info.plist-modify	2007-03-24 18:08:44 UTC (rev 88)
@@ -41,6 +41,8 @@
 			<string>$JAVAROOT/jerk.jar</string>
 		<key>Properties</key>
 		<dict>
+			<key>apple.awt.showGrowBox</key>
+			<string>false</string>
 			<key>com.apple.smallTabs</key>
 			<string>true</string>
 			<key>com.apple.macos.useScreenMenuBar</key>

Modified: rero/src-apple/jIRCii.app/Contents/Info.plist
===================================================================
--- rero/src-apple/jIRCii.app/Contents/Info.plist	2007-03-24 01:05:06 UTC (rev 87)
+++ rero/src-apple/jIRCii.app/Contents/Info.plist	2007-03-24 18:08:44 UTC (rev 88)
@@ -41,6 +41,8 @@
 			<string>$JAVAROOT/jerk.jar</string>
 		<key>Properties</key>
 		<dict>
+			<key>apple.awt.showGrowBox</key>
+			<string>false</string>
 			<key>com.apple.smallTabs</key>
 			<string>true</string>
 			<key>com.apple.macos.useScreenMenuBar</key>



From rsmudge at mail.berlios.de  Sat Mar 24 21:42:17 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sat, 24 Mar 2007 21:42:17 +0100
Subject: [Jircii-svn] r89 - in rero: . lib
Message-ID: <200703242042.l2OKgHU0009536@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-24 21:42:12 +0100 (Sat, 24 Mar 2007)
New Revision: 89

Modified:
   rero/lib/sleep.jar
   rero/readme.txt
Log:
phear-u-phear-me


Modified: rero/lib/sleep.jar
===================================================================
(Binary files differ)

Modified: rero/readme.txt
===================================================================
--- rero/readme.txt	2007-03-24 18:08:44 UTC (rev 88)
+++ rero/readme.txt	2007-03-24 20:42:12 UTC (rev 89)
@@ -31,11 +31,11 @@
 [raffi at beardsley ~/rero]$ ant docs
 
 To be safe:
-This code is (c) 2004 Raphael Mudge.  We can go back as far as 1999 if you like.
-That is when I started the jIRC project.  
+This code is (c) 2004-2007 Raphael Mudge.  We can go back as far as 1999 if 
+you like.  That is when I started the jIRC project.  
 
-The sleep library is (c) 2004 Raphael Mudge.  Sleep is distributed under the
-LGPL license.  I like sleep.  
+The sleep library is (c) 2004-2007 Raphael Mudge.  Sleep is distributed under 
+the LGPL license.  I like sleep.  
 
 The sleep library is available at http://jirc.hick.org/sleep/
 



From rsmudge at mail.berlios.de  Sat Mar 24 21:48:18 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sat, 24 Mar 2007 21:48:18 +0100
Subject: [Jircii-svn] r91 - rero/resources/toplevel
Message-ID: <200703242048.l2OKmIA9010364@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-24 21:48:18 +0100 (Sat, 24 Mar 2007)
New Revision: 91

Modified:
   rero/resources/toplevel/readme.txt
Log:
blah...


Modified: rero/resources/toplevel/readme.txt
===================================================================
--- rero/resources/toplevel/readme.txt	2007-03-24 20:43:23 UTC (rev 90)
+++ rero/resources/toplevel/readme.txt	2007-03-24 20:48:18 UTC (rev 91)
@@ -1,5 +1,5 @@
  ------- -------------------- ---------   ---------------  ------- ---------
-jIRCii - Beta (41) 03.23.07 - README
+jIRCii - Beta (41) 03.24.07 - README
 -  ------------- -------- -   ---------------- --       -    -     -     - - -
 
 The official jIRCii homepage is at: http://jircii.hick.org



From rsmudge at mail.berlios.de  Sun Mar 25 18:16:55 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sun, 25 Mar 2007 18:16:55 +0200
Subject: [Jircii-svn] r93 - in rero: lib resources/toplevel src/rero/config
Message-ID: <200703251616.l2PGGtk4023710@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-25 18:16:53 +0200 (Sun, 25 Mar 2007)
New Revision: 93

Modified:
   rero/lib/sleep.jar
   rero/resources/toplevel/whatsnew.txt
   rero/src/rero/config/ClientDefaults.java
Log:
one small change... :)


Modified: rero/lib/sleep.jar
===================================================================
(Binary files differ)

Modified: rero/resources/toplevel/whatsnew.txt
===================================================================
--- rero/resources/toplevel/whatsnew.txt	2007-03-25 05:02:44 UTC (rev 92)
+++ rero/resources/toplevel/whatsnew.txt	2007-03-25 16:16:53 UTC (rev 93)
@@ -1,3 +1,8 @@
+Beta    41 last minute update 25 Mar 07 :)
+====
+- Small last minute update to unbreak a potential issue with script
+  debugging.  This really only affects scripters.  My apologies.
+
 Beta    41 release 24 Mar 07
 ====
 - Updated to Sleep 2.1-b14 (is it even released yet?).  Lots of changes.

Modified: rero/src/rero/config/ClientDefaults.java
===================================================================
--- rero/src/rero/config/ClientDefaults.java	2007-03-25 05:02:44 UTC (rev 92)
+++ rero/src/rero/config/ClientDefaults.java	2007-03-25 16:16:53 UTC (rev 93)
@@ -78,7 +78,7 @@
 
    public static final boolean update_ial     = true;
 
-   public static final String  version_string = "03.24.07";
+   public static final String  version_string = "03.25.07";
 
    static
    {



From rsmudge at mail.berlios.de  Sun Mar 25 18:18:16 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sun, 25 Mar 2007 18:18:16 +0200
Subject: [Jircii-svn] r94 - rero/src/rero/util
Message-ID: <200703251618.l2PGIGh5023810@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-25 18:18:16 +0200 (Sun, 25 Mar 2007)
New Revision: 94

Modified:
   rero/src/rero/util/ClientUtils.java
Log:
:)


Modified: rero/src/rero/util/ClientUtils.java
===================================================================
--- rero/src/rero/util/ClientUtils.java	2007-03-25 16:16:53 UTC (rev 93)
+++ rero/src/rero/util/ClientUtils.java	2007-03-25 16:18:16 UTC (rev 94)
@@ -570,7 +570,7 @@
 
     public static File getFile(String file)
     {
-        if (file.charAt(0) == '~' && System.getProperty("user.home") != null)
+        if (file.length() > 0 && file.charAt(0) == '~' && System.getProperty("user.home") != null)
         {
             return new File(System.getProperty("user.home").toString(), file.substring(1));
         }



From rsmudge at mail.berlios.de  Sun Mar 25 18:26:30 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sun, 25 Mar 2007 18:26:30 +0200
Subject: [Jircii-svn] r95 - rero
Message-ID: <200703251626.l2PGQUGA024490@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-25 18:26:30 +0200 (Sun, 25 Mar 2007)
New Revision: 95

Modified:
   rero/Package.sh
Log:
small change to package script to fix mneptok's complaint.


Modified: rero/Package.sh
===================================================================
--- rero/Package.sh	2007-03-25 16:18:16 UTC (rev 94)
+++ rero/Package.sh	2007-03-25 16:26:30 UTC (rev 95)
@@ -57,7 +57,7 @@
 # Create Generic jIRCii Package
 #
 mv temp jIRCii
-tar zcf ./jerk.tgz ./jIRCii
+tar zcf ./jerk.tgz jIRCii
 
 #
 # Create Windows jIRCii Package



From rsmudge at mail.berlios.de  Sun Mar 25 18:28:43 2007
From: rsmudge at mail.berlios.de (rsmudge at BerliOS)
Date: Sun, 25 Mar 2007 18:28:43 +0200
Subject: [Jircii-svn] r96 - rero/resources/toplevel
Message-ID: <200703251628.l2PGShKk024645@sheep.berlios.de>

Author: rsmudge
Date: 2007-03-25 18:28:43 +0200 (Sun, 25 Mar 2007)
New Revision: 96

Modified:
   rero/resources/toplevel/whatsnew.txt
Log:
..


Modified: rero/resources/toplevel/whatsnew.txt
===================================================================
--- rero/resources/toplevel/whatsnew.txt	2007-03-25 16:26:30 UTC (rev 95)
+++ rero/resources/toplevel/whatsnew.txt	2007-03-25 16:28:43 UTC (rev 96)
@@ -2,6 +2,8 @@
 ====
 - Small last minute update to unbreak a potential issue with script
   debugging.  This really only affects scripters.  My apologies.
+- Added a jircii.xpm icon image for Linux users to the extra/ directory
+  submitted by mneptok, so thank him if you get a chance.
 
 Beta    41 release 24 Mar 07
 ====



